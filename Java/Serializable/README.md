# μ§λ ¬ν™”

<aside>
π’΅ μλ°” μ–Έμ–΄μ—μ„ μ‚¬μ©λλ” Object λλ” Dataλ¥Ό λ‹¤λ¥Έ μ»΄ν“¨ν„°μ μλ°” μ‹μ¤ν…μ—μ„λ„ μ‚¬μ©ν•  μ μλ„λ΅ `λ°”μ΄νΈ μ¤νΈλ¦Ό ν•νƒ`λ΅ `μ—°μ†μ μΈ(Serial) λ°μ΄ν„°`λ΅ λ³€ν™”ν•λ” ν¬λ§· λ³€ν™ κΈ°μ 

</aside>

κ° PC μ OS λ§λ‹¤ μ„λ΅ λ‹¤λ¥Έ κ°€μƒ λ©”λ¨λ¦¬ μ£Όμ† κ³µκ°„μ„ κ°–κΈ° λ•λ¬Έμ—, Reference Typeμ λ°μ΄ν„°λ“¤μ€ μΈμ¤ν„΄μ¤λ¥Ό μ „λ‹¬ν•  μ μ—†λ‹¤. β†’ μ£Όμ† κ°’μ΄ μ•„λ‹ Byte ν•νƒλ΅ μ§λ ¬ν™”λ κ°μ²΄ λ°μ΄ν„°λ¥Ό μ „λ‹¬ν•΄μ•Όν•λ‹¤.

μ§λ ¬ν™”λ λ°μ΄ν„°λ“¤μ€ λ¨λ‘ Primitive Typeμ΄ λκ³ , μ΄λ” νμΌ μ €μ¥μ΄λ‚ λ„¤νΈμ›ν¬ μ „μ†΅ μ‹ νμ‹±μ΄ κ°€λ¥ν• μ μλ―Έν• λ°μ΄ν„°κ°€ λλ‹¤. μ „μ†΅ λ° μ €μ¥μ΄ κ°€λ¥ν• λ°μ΄ν„°λ΅ λ§λ“¤μ–΄μ£Όλ” κ²ƒμ΄ **μ§λ ¬ν™”**μ΄λ‹¤.

**μ—­μ§λ ¬ν™”** : μ§λ ¬ν™”λ λ°μ΄ν„°λ¥Ό λ°›λ” μ½μ—μ„ λ‹¤μ‹ κ°μ²΄ λ°μ΄ν„°λ΅ λ³€ν™ν•λ” μ‘μ—…

![Serialization](assets/Serialization.png)

### μ§λ ¬ν™”λ¥Ό μ‚¬μ©ν•λ” κ³³

- JVMμ— μƒμ£Όν•λ” λ°μ΄ν„°λ¥Ό μμ†ν™”
- Servlet Session
  - μ„Έμ… λ°μ΄ν„°λ¥Ό μ €μ¥&κ³µμ  ν•΄μ•Όν•  λ• μ§λ ¬ν™”λ¥Ό μ΄μ©
- Cache
  - λ°μ΄ν„°λ² μ΄μ¤λ΅λ¶€ν„° μ΅°νν• κ°μ²΄λ¥Ό λ‹¤λ¥Έ λ¨λ“μ—μ„λ„ ν•„μ”ν•  λ• μ¬μ°¨ DBλ¥Ό μ΅°νν•λ” κ²ƒμ΄ μ•„λ‹, κ°μ²΄λ¥Ό μ§λ ¬ν™”ν•μ—¬ λ©”λ¨λ¦¬λ‚ μ™Έλ¶€ νμΌμ— μ €μ¥ν•΄ λ‘μ—λ‹¤κ°€ μ—­μ§λ ¬ν™”ν•μ—¬ μ‚¬μ©
  - μλ°” μ§λ ¬ν™”λ΅λ§ κ°€λ¥ν• κ²ƒμ€ μ•„λ‹λ‚ μλ°” μ‹μ¤ν…μ—μ„λ” κµ¬ν„μ΄ κ°„νΈν•΄μ„ λ§μ΄ μ‚¬μ©λλ‹¤.
  - But μ”μ¦μ€ Redis, Memcached μ™€ κ°™μ€ μΊμ‹ DBλ¥Ό λ§μ΄ μ‚¬μ©
- Java RMI (Remote Method Invocation)
  - μλ°” RMI λ” μ›κ²© μ‹μ¤ν… κ°„μ λ©”μ‹μ§€ κµν™μ„ μ„ν•΄μ„ μ‚¬μ©ν•λ” μλ°”μ—μ„ μ§€μ›ν•λ” κΈ°μ 
  - μµκ·Όμ—λ” μ†μΌ“μ„ μ΄μ©ν•΄μ„ μ•μ“°μ„

### μ§λ ¬ν™” κµ¬ν„

```java
@Entity
@AllArgsConstructor
@toString
public class Post implements Serializable {
private static final long serialVersionUID = 1L;

private String title;
private String content;
```

`serialVersionUID`λ¥Ό λ§λ“ λ‹¤. (Serializable μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„μ¤‘)

```java
Post post = new Post("μ λ©", "λ‚΄μ©");
byte[] serializedPost;
try (ByteArrayOutputStream baos = new ByteArrayOutputStream()) {
//ByteArrayOutputStream : μ§λ ¬ν™”λ λ°μ΄ν„°λ¥Ό λ©”λ¨λ¦¬ λ‚΄μ—μ„ μΊ΅μ²ν•λ”λ° μ‚¬μ©
    try (ObjectOutputStream oos = new ObjectOutputStream(baos)) {
    //ObjectOutputStream : κ°μ²΄λ¥Ό μ§λ ¬ν™”ν•μ—¬ λ°”μ΄νΈ μ¤νΈλ¦ΌμΌλ΅ λ³€ν™
        oos.writeObject(post);
				//post κ°μ²΄λ¥Ό μ§λ ¬ν™”
        serializedPost = baos.toByteArray();
    }
}
```

`ObjectOutputStream`μΌλ΅ μ§λ ¬ν™”λ¥Ό μ§„ν–‰ν•λ‹¤. Byteλ΅ λ³€ν™λ κ°’μ„ μ €μ¥ν•λ©΄ λλ‹¤.

### μ—­μ§λ ¬ν™”

```java
try (ByteArrayInputStream bais = new ByteArrayInputStream(serializedPost)) {
    try (ObjectInputStream ois = new ObjectInputStream(bais)) {

        Object objectPost = ois.readObject();
        Post post = (Post) objectPost;
    }
}
```

### **μ§λ ¬ν™” serialVersionUID :**

**μ§λ ¬ν™” λ κ°μ²΄κ°€ μ—­μ§λ ¬ν™” λ  λ•, ν΄λμ¤ λ²„μ „μ΄ νΈν™λλ” μ§€ κ²€μ‚¬ν•λ”λ° μ‚¬μ©λλ” μ λ‹ν¬ν• λ²„μ „ λ²νΈ**

β€Ά μλ°” μ‹μ¤ν…μ€ **`serialVersionUID`**λ¥Ό λ…μ‹μ μΌλ΅ μ„ μ–Έν•μ§€ μ•μ€ κ²½μ°, ν΄λμ¤μ μ„Έλ¶€ μ‚¬ν•­(λ©¤λ²„ λ³€μ, λ©”μ†λ“ λ“±)μ„ κΈ°λ°μΌλ΅ ν•΄μ‹κ°’ κ°™μ€ κ°’μ„ μλ™ μƒμ„±ν•μ—¬ ν• λ‹Ήν•©λ‹λ‹¤. ν•μ§€λ§ ν΄λμ¤κ°€ μμ •λλ©΄ μ΄ ν•΄μ‹κ°’λ„ λ³€κ²½λ  μ μμµλ‹λ‹¤.
β€Ά ν΄λμ¤λ¥Ό μμ •ν•  λ•λ§λ‹¤ μλ™ μƒμ„±λ **`serialVersionUID`**κ°€ λ³€κ²½λλ©΄, μ΄μ „ λ²„μ „μ μ§λ ¬ν™”λ κ°μ²΄μ™€ μƒλ΅μ΄ ν΄λμ¤ λ²„μ „ κ°„μ νΈν™μ„± λ¬Έμ κ°€ λ°μƒν•  μ μμµλ‹λ‹¤. μ¦‰, λ³€κ²½λ ν΄λμ¤λ΅ μ΄μ „ λ²„μ „μ κ°μ²΄λ¥Ό μ—­μ§λ ¬ν™”ν•λ ¤ ν•  λ• **`InvalidClassException`** μ¤λ¥κ°€ λ°μƒν•  μ μμµλ‹λ‹¤.

### **serialVersionUIDλ¥Ό λ…μ‹μ μΌλ΅ μ„ μ–Έν•λ” μ΄μ **

β€Ά ν΄λμ¤μ κµ¬μ΅°κ°€ λ°”λ€μ–΄λ„ κΈ°μ΅΄μ— μ§λ ¬ν™”λ κ°μ²΄μ™€μ νΈν™μ„±μ„ μ μ§€ν•κΈ° μ„ν•΄μ„μ…λ‹λ‹¤. λ…μ‹μ μΌλ΅ **`serialVersionUID`**λ¥Ό μ„ μ–Έν•κ³ , ν΄λμ¤λ¥Ό μμ •ν•΄λ„ μ΄ κ°’μ„ λ³€κ²½ν•μ§€ μ•μΌλ©΄, μλ°” μ—­μ§λ ¬ν™” λ©”μ»¤λ‹μ¦μ€ μ—¬μ „ν κ°™μ€ ν΄λμ¤ λ²„μ „μΌλ΅ κ°„μ£Όν•©λ‹λ‹¤.

### μ§λ ¬ν™” μμ™Έ

### **InvalidClassException**

InvalidClassException μμ™Έλ” μ§λ ¬ν™”λ¥Ό μ΄μ©ν•λ‹¤λ³΄λ©΄ ν”ν μ ‘ν•  μ μλ” μ¤λ¥μ΄λ‹¤. μ΄ μμ™Έλ” μ•„λ 3κ°€μ§€ μ£Όμ” μ›μΈμΌλ΅ μΈν•΄ Β Serialized λλ” Deserialized ν•  μ μ—†λ‹¤λ” κ²ƒμ„ μλ―Έν•λ‹¤.

- ν΄λμ¤μ SerialVersionUID λ²„μ „μ΄ λ‹¤λ¥Έ κ²½μ°
- ν΄λμ¤μ— λ‹¤λ¥Έ λ°μ΄ν„° νƒ€μ…μ„ ν¬ν•¨ν• κ²½μ°
- κΈ°λ³Έ μƒμ„±μκ°€ μ—†λ” κ²½μ°

### NotSerializableException

Serializableμ„ κµ¬ν„ν•κ³  μμ§€λ§ λ‹¤λ¥Έ ν΄λμ¤μ κ°μ²΄λ¥Ό λ©¤λ²„ λ³€μλ΅ κ°€μ§€κ³  μμ„ κ²½μ°, κ·Έλ¦¬κ³  κ·Έ μ°Έμ΅°ν•κ³  μλ” ν΄λμ¤κ°€ Serializableμ„ κµ¬ν„ν•μ§€ μ•μ•μ„ κ²½μ°μ΄λ‹¤.

## μ§λ ¬ν™”μ μ¥λ‹¨μ 

### **μ§λ ¬ν™”μ μ¥μ :**

1. **ν”λ«νΌ λ…λ¦½μ **: μλ°” ν”λ«νΌ λ‚΄μ—μ„ κ°μ²΄μ μƒνƒλ¥Ό μ €μ¥ν•κ³  μ „μ†΅ν•  μ μμΌλ©°, JVM κ°„μ λ°μ΄ν„° κµν™μ„ μ©μ΄ν•κ² ν•©λ‹λ‹¤.
2. **κ°μ²΄ μ „μ²΄ μ €μ¥**: κ°μ²΄μ ν„μ¬ μƒνƒλ¥Ό λ¨λ‘ μ €μ¥ν•κ³ , λ³µμ΅ν• λ°μ΄ν„° κµ¬μ΅°λ¥Ό ν¬ν•¨ν• λ¨λ“  μ„Έλ¶€ μ •λ³΄λ¥Ό ν¬ν•¨ν•  μ μμµλ‹λ‹¤.
3. **μλ™ νƒ€μ… λ³µμ›**: μ—­μ§λ ¬ν™” κ³Όμ •μ—μ„ μλ°”λ” μλ™μΌλ΅ μ¬λ°”λ¥Έ λ°μ΄ν„° νƒ€μ…μΌλ΅ κ°μ²΄λ¥Ό λ³µμ›ν•μ—¬, μ¶”κ°€μ μΈ λ°μ΄ν„° λ§¤ν•‘μ΄λ‚ νμ‹± μ—†μ΄ μ¦‰μ‹ μ‚¬μ© κ°€λ¥ν•©λ‹λ‹¤.
4. **μ‹κ°„ ν¨μ¨μ„±**: λ³µμ΅ν• κ°μ²΄ κµ¬μ΅°λ¥Ό λ‹¤λ£¨λ” κ²½μ°, λ³„λ„μ νμ‹± κ³Όμ • μ—†μ΄ κ°μ²΄λ¥Ό μ „μ†΅ν•κ³  λ³µμ›ν•  μ μμ–΄ κ°λ° μ‹κ°„μ„ λ‹¨μ¶•ν•  μ μμµλ‹λ‹¤.

### **μ§λ ¬ν™”μ λ‹¨μ :**

1. **λ³΄μ• μ·¨μ•½μ **: μ§λ ¬ν™” λ°μ΄ν„°λ” λ³€κ²½μ΄ μ‰¬μ› μ•…μμ μΌλ΅ μ΅°μ‘λ  μ μμΌλ©°, μ—­μ§λ ¬ν™” κ³Όμ •μ—μ„ λ³΄μ• μ·¨μ•½μ μ΄ λ°μƒν•  μ μμµλ‹λ‹¤.
2. **νΈν™μ„± λ¬Έμ **: ν΄λμ¤ κµ¬μ΅°κ°€ λ³€κ²½λλ©΄ κΈ°μ΅΄μ— μ§λ ¬ν™”λ κ°μ²΄μ™€ νΈν™λμ§€ μ•μ„ μ μμ–΄ μ—­μ§λ ¬ν™” μ‹¤ν¨λ‚ μ¤λ¥λ¥Ό μ΄λν•  μ μμµλ‹λ‹¤.
3. **μ„±λ¥ μ΄μ**: ν¬κ³  λ³µμ΅ν• κ°μ²΄λ¥Ό μ§λ ¬ν™”ν•κ³  μ—­μ§λ ¬ν™”ν•λ” κ³Όμ •μ€ λ©”λ¨λ¦¬μ™€ μ²λ¦¬ μ‹κ°„μ„ λ§μ΄ μ†λ¨ν•  μ μμµλ‹λ‹¤.
4. **λ²”μ©μ„± λ¶€μ΅±**: μλ°” μ§λ ¬ν™”λ” μλ°” ν”λ«νΌμ— μΆ…μ†μ μ΄μ–΄μ„ λ‹¤λ¥Έ ν”„λ΅κ·Έλλ° μ–Έμ–΄λ‚ ν™κ²½μ—μ„λ” μ‚¬μ©ν•  μ μ—†μµλ‹λ‹¤.

μ¥μ λ³΄λ‹¤ λ‹¨μ μ΄ λ„λ¬΄ μΉλ…μ μ΄λΌμ„ JSON ν¬λ§·μ΄ ν›¨μ”¬ λ§μ΄ μ“°μΈλ‹¤.

## λ©΄μ ‘ μ§λ¬Έ

### 1. μλ°” μ§λ ¬ν™”κ°€ λ¬΄μ—‡μΈκ°€μ”?

λ‹µλ³€ μμ‹:
μλ°” μ§λ ¬ν™”λ” κ°μ²΄μ μƒνƒλ¥Ό λ°”μ΄νΈ μ¤νΈλ¦ΌμΌλ΅ λ³€ν™ν•λ” κ³Όμ •μΌλ΅, μ΄ λ°”μ΄νΈ μ¤νΈλ¦Όμ„ νμΌ, λ°μ΄ν„°λ² μ΄μ¤, λ©”λ¨λ¦¬ λ“±μ— μ €μ¥ν•κ±°λ‚ λ„¤νΈμ›ν¬λ¥Ό ν†µν•΄ μ „μ†΅ν•  μ μμµλ‹λ‹¤. μ§λ ¬ν™”λ λ°μ΄ν„°λ” λ‹¤λ¥Έ JVM(Java Virtual Machine)μ—μ„ μ—­μ§λ ¬ν™”ν•μ—¬ μ›λ κ°μ²΄μ μƒνƒλ΅ λ³µμ›ν•  μ μμµλ‹λ‹¤. μ΄ κ³Όμ •μ€ μλ°” μ‹μ¤ν…μ—μ„ κ°μ²΄μ λ°μ΄ν„°λ¥Ό μ μ§€ν•κ³ , JVM κ°„μ ν†µμ‹ μ„ μ©μ΄ν•κ² ν•λ” λ° μ¤‘μ”ν•©λ‹λ‹¤.

### 2. μ§λ ¬ν™”μ—μ„ serialVersionUIDλ” μ–΄λ–¤ μ—­ν• μ„ ν•λ‚μ”?

λ‹µλ³€ μμ‹:
serialVersionUIDλ” μ§λ ¬ν™”λ κ°μ²΄μ™€ ν•΄λ‹Ή κ°μ²΄μ ν΄λμ¤ λ²„μ „ κ°„ νΈν™μ„±μ„ μ μ§€ν•λ” λ° μ‚¬μ©λλ” κ³ μ  μ‹λ³„μμ…λ‹λ‹¤. ν΄λμ¤μ μ •μκ°€ λ³€κ²½λμ—μ„ λ•λ„ μ΄μ „μ— μ§λ ¬ν™”λ λ°μ΄ν„°λ¥Ό μ„±κ³µμ μΌλ΅ μ—­μ§λ ¬ν™”ν•  μ μλ„λ΅ λ„μ™€μ¤λ‹λ‹¤. serialVersionUIDκ°€ ν΄λμ¤ λ²„μ „κ³Ό μΌμΉν•μ§€ μ•μΌλ©΄ μ—­μ§λ ¬ν™” κ³Όμ •μ—μ„ InvalidClassExceptionμ΄ λ°μƒν•  μ μμµλ‹λ‹¤. λ”°λΌμ„, ν΄λμ¤κ°€ λ³€κ²½λ  λ•λ§λ‹¤ νΈν™μ„±μ„ μ μ§€ν•κ³ μ λ…μ‹μ μΌλ΅ serialVersionUIDλ¥Ό μ„ μ–Έν•λ” κ²ƒμ΄ μΆ‹μµλ‹λ‹¤.

μ¶μ²:

[https://inpa.tistory.com/entry/JAVA-β•-μ§λ ¬ν™”Serializable-μ™„λ²½-λ§μ¤ν„°ν•κΈ°](https://inpa.tistory.com/entry/JAVA-%E2%98%95-%EC%A7%81%EB%A0%AC%ED%99%94Serializable-%EC%99%84%EB%B2%BD-%EB%A7%88%EC%8A%A4%ED%84%B0%ED%95%98%EA%B8%B0)

[Inpa Dev π‘¨β€π’»:ν‹°μ¤ν† λ¦¬]
