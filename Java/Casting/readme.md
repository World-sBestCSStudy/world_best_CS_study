- (개념적) 하나의 데이터 타입을 다른 타입으로 바꾸는 것을 **형변환(캐스팅)** 이라고 한다.
- 변수가 원하는 정보를 다 만족하고 있어야 형 변환이 가능하다.
- 캐스팅의 주목적은 데이터를 바꾸는 것이 아니라 다형성 측면에서 사용되는 것

### 자바의 데이터형

- 기본형 (primitive type) - boolean, short, int, long, float, double, char
- 참조형 (reference type) - ClassType, InterfaceType, ArrayType, EnumType 등

기본형 데이터에서 캐스팅은 원칙적으로 데이터 손실을 막고자 한다. 

```java
int a = 1.0; //ERROR
```

따라서 int 형에 double형 데이터를 넣으려고 하면 데이터 손실을 막고자 error가 발생한다.

이 때 프로그래머는 데이터가 손실 된다는 것을 이미 알고 있고, OOP의 다형성을 이용하고 싶을 때 캐스팅을 사용한다. 

```java
int a = (int)1.0;
```

```java
double b = 1;
```

반대의 경우에서는 컴파일 에러가 뜨지 않는다. 변수가 원하는 정보를 충족하지 않는데 에러가 뜨지 않는 이유는? 

**기본형** 데이터 끼리의 캐스팅이기 때문에 → 기본형 타입은 이미 **컴파일러가 알고 있는** 자료형이므로 더블형 데이터의 형태를 추측으로 알 수 있다. 자동으로 컴파일러가 더블형으로 바꿔주는 것 

## 업 캐스팅과 다운 캐스팅

### 참조형의 경우는 ?

기본적으로 캐스팅은 서로 관련없는 데이터 끼리는 변환되지 않는다. 

```java
int a = (int)true; //ERROR
```

참조형 데이터 역시 마찬가지이다. 

참조형에서 데이터가 서로 관련 있는 경우는 어떤걸 의미할까? 

### 1. 상속관계 2. 인터페이스로 확장된 관계

Parent와 Child extends Parent 가 있는 경우에 

Child는 Parent 클래스를 상속 받으므로 Child 클래스가 Parent 클래스 보다 가지고 있는 데이터 양이 많다. 

```java
Parent parent = new Parent(); //참조형 사용 예시
```

parent 변수는 실제 데이터인 new Parent();란 인스턴스가 Parent 정보를 모두 가지고 있으므로 오류가 나지 않는다. 

```java
Parent parent = new Child(); 
```

new Child()의 경우도 Parent를 상속 받았기에 Parent가 필요한 정보를 모두 가지고 있으므로 오류가 나지 않는다.

이런 캐스팅을 **업 캐스팅**이라고 부른다.  Child → Parent  로 데이터를 넣는 형식이니까 

그럼 반대의 경우에는?

```java
Child child = new Parent() //ERROR
```

변수가 원하는 정보를 가지고 있지 않기에 **컴파일 오류**가 난다. Child의 데이터를 Parent가 전부 가지고 있지는 않기 때문에. 

```java
Child child = (Child)new Parent();
```

컴파일 오류에서는 벗어났지만, 런타임 오류가 발생한다. 

런타임 오류가 발생하는 이유는 ? 

JVM은 new Parent(); 인스턴스를 Child 데이터로 형변환 하려 했지만,Child 데이터가 무엇인지 알 수 없다. 

기본형 데이터 끼리는 추리가 가능하기 때문에,알아서 알맞은 데이터 크기로 변환하여 넣어준다. 하지만, 위와 같이 참조형 데이터를 캐스팅 할때는, 속성,성질이 정해져 있지 않은 참조형 데이터는 JVM이 추리할 수 없다. 

이런 경우를 **다운 캐스팅**이라고 한다.  (Parent → Child)

다운 캐스팅이 성립하는 상황은?

```java
Parent parent = new Child();
Child child = (Child)parent;
```

이와 같이 업캐스팅이 선행된 경우에는 다운 캐스팅이 성립한다. 

parent 변수는 Parent클래스 형태의 변수지만, 태생이 Child 인스턴스 인 데이터를 넣어 주었다.그러한 정보를 가지고 있는 parent 변수를 다시 Child 클래스형태로다운캐스팅 을 하였다.  parent변수 상태는 Parent 클래스형 상태이지만,다운캐스팅을 해주는 경우 ( (Child)parent ) 태생이 Child 클래스 형이므로,JVM이 parent 변수를 태생 정보인 Child 클래스 데이터 형으로 다운 캐스팅을 해줄 수 있는 것이다.

### 면접 질문

1. **업캐스팅이란 무엇이며, 자바에서 어떻게 사용됩니까?**

업캐스팅은 서브 클래스의 객체를 슈퍼 클래스 타입으로 변환하는 것을 말합니다. 이는 다형성을 활용하여 서브 클래스 객체를 일반화된 슈퍼 클래스 참조로 관리할 수 있게 해 줍니다

1. **다운캐스팅이란 무엇이고, 언제 사용하게 됩니까?**

다운캐스팅은 업캐스팅된 객체를 원래의 서브 클래스 타입으로 **되돌리는 것**입니다. 특정 서브 클래스에만 존재하는 메소드나 속성을 사용해야 할 때 필요합니다

1. **자바에서 `instanceof` 연산자의 역할은 무엇이며, 다운캐스팅과 어떤 관련이 있습니까?**

**`instanceof`** 연산자는 객체가 특정 클래스의 인스턴스인지를 확인합니다. 다운캐스팅을 수행하기 전에 **`instanceof`**를 사용하여 안전하게 타입을 확인하고, 잘못된 타입으로 캐스팅되어 `**ClassCastException`** 예외가 발생하는 것을 방지할 수 있습니다.

<참고 자료>

[JAVA - Casting(캐스팅)](https://mommoo.tistory.com/40)

https://mommoo.tistory.com/41

https://mommoo.tistory.com/51
