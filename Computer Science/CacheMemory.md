# 캐시 메모리

- 컴퓨터 시스템에서 프로세서(CPU)와 주 메모리(RAM) 사이에 위치하여 데이터 접근 속도를 높이는 역할을 하는 고속 메모리
- 캐시 메모리는 자주 사용되는 데이터와 명령어를 저장하여 프로세서가 더 빠르게 액세스할 수 있도록 함.  <br>
=> 속도가 빠른 장치와 느린 장치에서 속도 차이에 따른 병목 현상을 줄이고 성능을 크게 향상시킬 수 있음.

### 캐시 메모리의 계층 구조
1. L1 캐시 (Level 1 Cache):
- CPU 코어 내부에 통합된 가장 빠르고 작은 캐시.
- 일반적으로 32KB에서 128KB 정도의 용량을 가짐

2. L2 캐시 (Level 2 Cache):
- L1 캐시보다 크지만 약간 느림.
- 일반적으로 몇백 KB에서 몇 MB까지의 용량을 가짐.
- 각 코어마다 독립적으로 존재할 수도 있고, 여러 코어가 공유할 수도 있음.

3. L3 캐시 (Level 3 Cache):
- L2 캐시보다 더 크고 느림.
- 수 MB에서 수십 MB까지의 용량을 가짐.
- 일반적으로 여러 CPU 코어가 공유

=> 계층을 나눈 이유 : 효율적인 성능 향상을 위해(속도가 빠를수록 비용이 증가하기 때문)

### 캐시 메모리 작동 원리
1. 시간 지역성 : 
- 프로그램이 최근에 접근한 데이터를 다시 접근할 가능성이 높다는 개념.
- 예를 들어, 루프 내에서 반복적으로 사용되는 변수나 함수 호출은 시간이 지남에 따라 자주 사용되므로, 해당 데이터를 캐시에 저장해 두면 캐시 히트율을 높일 수 있음.  <br>
- 캐시 메모리는 시간 지역성을 최대한 활용하기 위해 자주 접근하는 데이터를 캐시에 저장함.  <br>
- L1 캐시는 특히 자주 접근하는 데이터를 저장하여 CPU가 매우 빠르게 접근할 수 있도록 함.

2. 공간 지역성 : 
- 프로그램이 특정 메모리 위치를 접근하면, 그 근처의 메모리 위치도 곧 접근할 가능성이 높다는 개념.  <br>
- 배열이나 연속적인 데이터 구조를 처리할 때 주로 나타남.
- 캐시 메모리는 공간 지역성을 활용하기 위해 데이터 블록(캐시 라인)을 단위로 데이터를 가져옴.
- 예를 들어, CPU가 array[i]를 요청하면 array[i+1], array[i+2] 등의 데이터를 포함하는 캐시 라인이 캐시에 로드되고, 이를 통해 연속된 데이터 접근 시 캐시 히트율을 높일 수 있음.

3. 캐시 히트(Cache Hit): 
- CPU가 요청한 데이터가 캐시 메모리에 존재할 때 발생.
- 이 경우 CPU는 데이터를 매우 빠르게 읽을 수 있음.

4. 캐시 미스(Cache Miss): 
- CPU가 요청한 데이터가 캐시에 없을 때 발생. 
- 이 경우 데이터는 주 메모리에서 읽어와 캐시에 저장된 후 CPU에 제공됨

5. 캐시 일관성(Cache Coherence): 
- 멀티코어 시스템에서는 각 코어의 캐시가 같은 데이터를 일관되게 유지하도록 해야 함
- 이를 위해 여러 일관성 프로토콜이 사용됩니다(예: MESI 프로토콜).

### 캐시 메모리의 배치
1. 직접 매핑(Direct Mapping): 각 메모리 블록이 캐시의 특정 위치에만 저장될 수 있고, 구현이 간단하지만 충돌이 많이 발생할 수 있음.
2. 연관 매핑(Associative Mapping): 메모리 블록이 캐시의 어느 위치에나 저장될 수 있어 충돌이 적지만 구현이 복잡하고 비용이 많이 들어감.
3. 집합 연관 매핑(Set-Associative Mapping): 직접 매핑과 연관 매핑의 절충안으로, 캐시는 여러 집합으로 나뉘고 각 집합 내에서 연관 매핑이 이루어짐.

### 캐시 대체 알고리즘
1. LRU(Least Recently Used): 가장 오랫동안 사용되지 않은 데이터를 대체.
2. FIFO(First In First Out): 가장 먼저 저장된 데이터를 대체.
3. LFU(Least Frequently Used): 가장 적게 사용된 데이터를 대체.

### 면접 질문
- **캐시 메모리에 대해 설명해주세요.** <br>
컴퓨터 시스템에서 프로세서(CPU)와 주 메모리(RAM) 사이에 위치하여 데이터 접근 속도를 높이는 역할을 하는 고속 메모리를 캐시 메모리라고 합니다.  <br>
자주 사용되는 데이터와 명령어를 저장하여 프로세서가 더 빠르게 액세스할 수 있도록 함으로써 프로세서와 주 메모리의 속도차이에 따른 병목 현상을 줄이고  <br>
성능을 크게 향상시킬 수 있습니다.


- **캐시 지역성에 대해 설명해주세요.** <br>
프로그램에서 메모리의 접근이 균등하게 일어나지 않는다는 전제를 두고, 어떤 메모리에 접근할 때 띄는 특성이 있다는 것을 의미합니다.   <br>
예를들면, 최근에 참조됐던 내용이 다시 참조될 확률이 높다는 시간 지역성, 그리고 참조된 주소의 인접한 주소가 참조될 확률이 높다는 공간 지역성 등이 있습니다.  <br>
이러한 지역성을 활용하여 캐시 메모리에서는 조금 더 효율적으로 데이터를 저장하고 있습니다.
